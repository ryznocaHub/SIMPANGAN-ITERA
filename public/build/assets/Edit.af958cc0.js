import{a as T}from"./Show.8b9d02d8.js";import{_ as V}from"./Container.fd7110e0.js";import{_ as N}from"./Input.d1f1fc38.js";import{_ as b}from"./Label.23df5a7a.js";import{_ as R}from"./index.3a9c2ea0.js";import{u as j,o as f,c as I,w as k,d as s,b as e,e as _,f as P,t as c,g as x,a as i,U as H,V as A}from"./app.35366383.js";import{N as C}from"./Notification.a0596bc5.js";import{_ as B}from"./Header1.57f707b5.js";import"./Master.6e78ae6a.js";import"./sweetalert2.all.995333e0.js";const E={class:"h3 text-xl font-extrabold tracking-wider flex"},F=P(" Data HPS "),D={key:0},L={key:1,class:"tooltip tooltip-bottom flex text-sm align-bottom text-secondary","data-tip":"Lebih mahal dari harga RAB"},q=s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-trending-up text-secondary ml-3 mr-1"},[s("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),s("polyline",{points:"17 6 23 6 23 12"})],-1),M={key:2,class:"tooltip tooltip-bottom flex text-sm align-bottom text-first","data-tip":"Lebih murah dari harga RAB"},O=s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-trending-down text-first ml-3 mr-1"},[s("polyline",{points:"23 18 13.5 8.5 8.5 13.5 1 6"}),s("polyline",{points:"17 18 23 18 23 12"})],-1),U=s("div",{class:"divider"},null,-1),G={class:"flex flex-wrap"},z={class:"flex flex-col basis-1/2 pr-5"},J={key:0,class:"text-sm text-error mt-1 mb-5"},K={class:"flex flex-col"},Q={class:"font-bold text-lg tracking-wider"},W={class:"flex flex-col basis-1/2 mt-5"},X={class:"font-bold text-lg tracking-wider"},Y={key:0,class:"text-sm text-error mt-1 mb-5"},Z={key:2,class:"mb-5"},tt=["href"],et={key:4,class:"text-sm text-error mt-1 mb-5"},st={class:"flex justify-between"},ot=["href"],at={__name:"Index",props:{items:{type:Object}},emits:["successVerification","editTotal"],setup(m,{emit:h}){const n=m,v=C();function o(u){for(var a="",p=u.toString().split("").reverse().join(""),S=0;S<p.length;S++)S%3==0&&(a+=p.substr(S,3)+".");return"Rp. "+a.split("",a.length-1).reverse().join("")}const t=j({price:n.items.estimate_price,unit:n.items.quantity,source:n.items.estimate_source,file:n.items.estimate_file,total:n.items.estimate_total,status:1}),w=()=>{t.price=n.items.estimate_price,t.unit=n.items.quantity,t.source=n.items.estimate_source,t.file=n.items.estimate_file,t.total=n.items.estimate_total,t.status=1},d=j({fileName:n.items.estimate_file,status:0}),y=()=>{t.total=t.unit*t.price,t.status=0},$=()=>{t.unit=n.items.quantity,t.price=n.items.price,t.source=n.items.source,t.file=null,t.status=0,d.status=0,y()},g=()=>{t.post(route("hps.item.updateHPS",n.items.id),{onSuccess:u=>{h("editTotal",t,n.items.estimate_total),h("successVerification",n.items.id),v("success","Berhasil ubah data "+n.items.name)},onError:u=>{console.log(u),v("error","Gagal merubah data "+n.items.name)},onStart:()=>t.clearErrors(),onFinish:()=>{w(),d.reset()}})};function l(u){d.status=1,t.file=u.target.files,t.source="",d.fileName=u.target.files[0].name,t.status=0}function r(u){d.fileName=null,t.file=null,t.status=0,d.status=1,t.clearErrors("file")}return(u,a)=>(f(),I(V,{class:"ml-5 card border-2 bg-grey-50 border-dashed border-gray-600 p-5 w-1/3"},{default:k(()=>[s("span",E,[F,e(t).total==0?(f(),_("div",D)):e(t).total>m.items.total?(f(),_("span",L,[q,P(" "+c(o(e(t).total-m.items.total)),1)])):e(t).total<m.items.total?(f(),_("span",M,[O,P(" "+c(o(m.items.total-e(t).total)),1)])):x("",!0)]),U,s("div",G,[s("div",z,[i(b,{value:"Harga Satuan"}),i(N,{id:"price",type:"number",class:"mt-1 block w-full",modelValue:e(t).price,"onUpdate:modelValue":a[0]||(a[0]=p=>e(t).price=p),modelModifiers:{number:!0},min:"1000",status:e(t).errors.price,onChange:a[1]||(a[1]=p=>y()),placeholder:"Harga Satuan"},null,8,["modelValue","status"]),e(t).errors.price?(f(),_("div",J,c(e(t).errors.price),1)):x("",!0)]),s("div",K,[i(b,{value:"Jumlah"}),s("p",Q,c(m.items.quantity)+" "+c(m.items.unit),1)]),s("div",W,[i(b,{value:"Total"}),s("p",X,c(o(e(t).unit*e(t).price)),1)])]),i(b,{value:"Sumber",class:"mt-5"}),i(N,{class:"w-full",type:"text",modelValue:e(t).source,"onUpdate:modelValue":a[2]||(a[2]=p=>e(t).source=p),onChange:r,status:e(t).errors.source},null,8,["modelValue","status"]),e(t).errors.source?(f(),_("div",Y,c(e(t).errors.source),1)):x("",!0),!e(d).fileName||e(d).status==0?(f(),_("input",{key:1,class:"mb-5",type:"file",accept:".pdf",onInput:a[3]||(a[3]=p=>l(p))},null,32)):(f(),_("div",Z,c(e(d).fileName),1)),e(d).status==0&&e(t).file&&!e(t).source?(f(),_("a",{key:3,class:"mb-5 text-sm font-bold text-first underline underline-offset-8",href:e(d).fileName,download:"",target:"_self"},"Lihat File "+c(e(t).source),9,tt)):x("",!0),e(t).errors.file?(f(),_("div",et,c(e(t).errors.file),1)):x("",!0),s("div",st,[H(s("a",{class:"hover:bg-none text-xs text-first underline underline-offset-8",id:"visit",href:e(t).source,target:"_blank"}," Kunjungi Sumber ",8,ot),[[A,e(t).source]]),e(t).total!=0&&e(t).total!=null&&(e(t).source!=""&&e(t).source!=null||e(t).file!=null)?(f(),_("button",{key:0,class:"btn btn-xs text-white bg-first border-none font-bold",id:"use",onClick:a[4]||(a[4]=p=>g())}," Verifikasi ")):x("",!0),s("button",{class:"btn btn-xs text-first bg-slate-200 border-none hover:text-white hover:bg-first font-bold",id:"use",onClick:a[5]||(a[5]=p=>$())}," Gunakan Sumber RAB ")])]),_:1}))}},rt={class:"flex mb-10 text-start"},nt={class:"font-bold text-lg tracking-wider mb-3"},it={class:"font-bold text-lg tracking-wider mb-3"},lt={class:"font-bold text-lg tracking-wider mb-3"},ct={class:"font-bold text-lg tracking-wider mb-3"},ut={class:"form-control"},mt={class:"label cursor-pointer"},dt=s("span",{class:"label-text"},"Rp. 0",-1),pt={class:"form-control"},ft={class:"label cursor-pointer"},ht={class:"label-text"},bt={class:"font-bold text-lg tracking-wider mb-3"},_t={class:"flex"},gt=s("div",{class:"self-center ml-3 place-self-center"},"%",-1),vt={class:"font-bold text-lg tracking-wider mb-3"},xt=["onClick"],It={__name:"Edit",props:{items:{type:Object},procurement:{type:Object},id:{type:Number}},setup(m){const h=m,n=C();function v(l){var r=Math.ceil(parseInt(l))%parseInt(100)==0?Math.ceil(parseInt(l)):Math.round((parseInt(l)+parseInt(100)/2)/parseInt(100))*parseInt(100);return r}const o=j({sub_total:h.procurement.estimate.sub_total,ppn:v(.11*(h.procurement.estimate.sub_total+h.procurement.estimate.overheat)),overheat:h.procurement.estimate.overheat,percentage:h.procurement.estimate.overheat_percentage,chooser:0,_method:"patch",status:6}),t=l=>{const r=.11*(o.sub_total+o.overheat);o.ppn=v(r),o.chooser=l},w=l=>{console.log("sub",o.sub_total,"overheat",o.overheat,"ppn",o.ppn,"chooser",o.chooser);const r=l*o.sub_total/100;o.overheat=v(r),t(o.chooser)},d=(l,r)=>{if(l.status==1)return 0;o.sub_total=o.sub_total+l.total-r,w(o.percentage),console.log("overheat",o.overheat,"sub_total",o.sub_total)},y=()=>{o.chooser=0},$=l=>{o.post(route("hps.procurement.update",h.id),{onSuccess:r=>n("success","Berhasil ajukan HPS "+h.procurement.name),onError:r=>n("error","Gagal ajukan HPS "+h.procurement.name),onStart:()=>l(),onFinish:()=>l()})};function g(l){for(var r="",u=l.toString().split("").reverse().join(""),a=0;a<u.length;a++)a%3==0&&(r+=u.substr(a,3)+".");return"Rp. "+r.split("",r.length-1).reverse().join("")}return(l,r)=>(f(),I(T,{items:m.items},{default:k(({data:u,successVerification:a,loading:p})=>[i(at,{items:u,onSuccessVerification:a,onEditTotal:d,onLoading:p},null,8,["items","onSuccessVerification","onLoading"])]),status:k(({loading:u})=>[i(R,{text:"Semua RAB sudah dibuatkan HPS. Silahkan ajukan HPS"},{default:k(()=>[s("div",rt,[i(V,{class:"w-6/12"},{default:k(()=>[i(B,{title:"Data RAB",widthSize:"40"}),i(b,{value:"Sub Total",class:"mt-5"}),s("p",nt,[s("span",null,c(g(m.procurement.budget_plan.sub_total)),1)]),i(b,{value:"PPN",class:"mt-5"}),s("p",it,[s("span",null,c(g(m.procurement.budget_plan.ppn)),1)]),i(b,{value:"Total",class:"mt-5"}),s("p",lt,[s("span",null,c(g(m.procurement.budget_plan.total)),1)])]),_:1}),i(V,{class:"ml-10 w-6/12"},{default:k(()=>[i(B,{title:"Data HPS",widthSize:"40"}),i(b,{value:"Sub Total",class:"mt-5"}),s("p",ct,[s("span",null,c(g(e(o).sub_total)),1)]),i(b,{value:"PPN",class:"mt-5"}),s("div",ut,[s("label",mt,[s("input",{type:"radio",name:"radio-6",class:"radio checked:bg-blue-500",checked:"",onInput:r[0]||(r[0]=a=>y())},null,32),dt])]),s("div",pt,[s("label",ft,[s("input",{type:"radio",name:"radio-6",class:"radio checked:bg-blue-500",onInput:r[1]||(r[1]=a=>t(1))},null,32),s("span",ht,c(g(e(o).ppn)),1)])]),i(b,{value:"Overheat",class:"mt-5"}),s("p",bt,[s("span",null,c(g(e(o).overheat)),1)]),s("div",_t,[i(N,{id:"provit",type:"number",class:"mt-1 w-6/12",modelValue:e(o).percentage,"onUpdate:modelValue":r[2]||(r[2]=a=>e(o).percentage=a),onInput:r[3]||(r[3]=a=>w(a.target.value))},null,8,["modelValue"]),gt]),i(b,{value:"Total",class:"mt-5"}),s("p",vt,[s("span",null,c(g(e(o).sub_total+e(o).overheat+e(o).ppn*e(o).chooser)),1)])]),_:1})]),s("button",{class:"btn gap-2 bg-first border-none",onClick:a=>$(u)}," Ajukan HPS ",8,xt)]),_:2},1024)]),_:1},8,["items"]))}};export{It as default};
