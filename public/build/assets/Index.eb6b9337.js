import{_ as V}from"./Master.6e78ae6a.js";import{u as x,o as n,c as w,w as c,a as l,f as y,t as f,b as o,e as u,d as t,g as _,L as S,r as j}from"./app.35366383.js";import{_ as C}from"./Container.fd7110e0.js";import{_ as v}from"./Input.d1f1fc38.js";import{_ as h}from"./Header1.57f707b5.js";import{_ as N}from"./index.4269f55c.js";import{h as D}from"./moment.9709ab41.js";import{N as $}from"./Notification.a0596bc5.js";import"./sweetalert2.all.995333e0.js";const E={key:0},P={key:1},T={key:0},z=["for"],U=["id"],K=["for"],L={class:"modal-box relative",for:""},M=["for"],F={key:0,class:"text-sm text-error mt-1 mb-5"},G={class:"flex justify-center my-5"},q=["onClick"],I=["for"],J=["id"],O=["for"],H={class:"modal-box relative",for:""},Q=["for"],W={key:0,class:"text-sm text-error mt-1 mb-5"},X={class:"flex justify-center my-5"},Y=["onClick"],Z={key:1},tt={key:2},et=y("Lihat"),mt={__name:"Index",props:{procurements:{type:Object,required:!0}},setup(g){const b=$(),B=[{text:"Tanggal Masuk",value:"date",sortable:!0},{text:"No Akun",value:"account",sortable:!0},{text:"Judul Paket",value:"name",sortable:!0},{text:"Kategori",value:"category",sortable:!0},{text:"Status",value:"status",sortable:!0},{text:"Kode RUP",value:"rup_code",sortable:!0},{text:"Nilai RAB",value:"budget_plan.total",sortable:!0},{text:"Persetujuan RAB",value:"approval"},{text:"aksi",value:"aksi"}],i=x({_method:"patch",comment:"",status:3}),a=x({_method:"patch",rup_code:"",status:4}),A=(m,r)=>{console.log("func",r),a.post(route("siren.procurement.update",m),{onSuccess:()=>{b("success","Berhasil menyetujui RAB - "+a.rup_code),a.reset()},onError:p=>{console.log(p),b("error","Gagal menyetujui RAB")},onStart:p=>{a.clearErrors(),r()},onFinish:()=>r()})},R=m=>{i.post(route("siren.procurement.update",m),{onSuccess:()=>b("success","Berhasil menolak RAB"),onError:r=>b("error","Gagal menolak RAB "),onStart:r=>{i.clearErrors()}})};return(m,r)=>{const p=j("EasyDataTable");return n(),w(V,null,{default:c(({loading:k})=>[l(h,{title:"Daftar Pengadaan",widthSize:"100"}),l(C,{class:"max-h-[80vh] pb-10"},{default:c(()=>[l(p,{headers:B,items:g.procurements,sortBy:"status",sortType:"asc","rows-per-page":5,maxPaginationNumber:10,"table-class-name":"customize-table","buttons-pagination":""},{"item-date":c(({timeline:e})=>[y(f(o(D)(e.rab_submitted).format("DD-MM-yy")),1)]),"item-status":c(({status:e})=>[l(N,{status:e},null,8,["status"])]),"item-rup_code":c(({rup_code:e})=>[e?(n(),u("div",E,f(e),1)):(n(),u("div",P,"---"))]),"item-approval":c(({status:e,id:s})=>[e==2?(n(),u("div",T,[t("label",{for:s+"tolak",class:"btn text-first btn-xs bg-slate-200 border-none hover:text-white hover:bg-first font-bold"},"Tolak",8,z),t("input",{type:"checkbox",id:s+"tolak",class:"modal-toggle"},null,8,U),t("label",{for:s+"tolak",class:"modal cursor-pointer"},[t("label",L,[t("label",{for:s+"tolak",class:"btn btn-xs border-first bg-first btn-circle absolute right-2 top-2"},"\u2715",8,M),l(h,{title:"Alasan Penolakan RAB",class:"mt-3 mb-6",widhSize:"50"}),l(v,{type:"text",class:"block w-full",modelValue:o(i).comment,"onUpdate:modelValue":r[0]||(r[0]=d=>o(i).comment=d),status:o(i).errors.comment},null,8,["modelValue","status"]),o(i).errors.comment?(n(),u("div",F,f(o(i).errors.comment),1)):_("",!0),t("div",G,[t("button",{onClick:d=>R(s),class:"btn border-first bg-first"},"Tolak RAB",8,q)])])],8,K),t("label",{for:s,class:"btn btn-xs border-first modal-button bg-first ml-3"},"Setuju",8,I),t("input",{type:"checkbox",id:s,class:"modal-toggle"},null,8,J),t("label",{for:s,class:"modal cursor-pointer"},[t("label",H,[t("label",{for:s,class:"btn btn-xs border-first bg-first btn-circle absolute right-2 top-2"},"\u2715",8,Q),l(h,{title:"Kode RUP",class:"mt-3 mb-6",widhSize:"50"}),l(v,{type:"text",class:"block w-full",modelValue:o(a).rup_code,"onUpdate:modelValue":r[1]||(r[1]=d=>o(a).rup_code=d),status:o(a).errors.rup_code},null,8,["modelValue","status"]),o(a).errors.rup_code?(n(),u("div",W,f(o(a).errors.rup_code),1)):_("",!0),t("div",X,[t("button",{onClick:d=>A(s,k),class:"btn border-first bg-first"},"Verifikasi RAB",8,Y)])])],8,O)])):_("",!0),e==3?(n(),u("div",Z,"RAB Ditolak")):_("",!0),e>3?(n(),u("div",tt,"RAB Diterima")):_("",!0)]),"item-aksi":c(({id:e})=>[l(o(S),{onClick:s=>k(),href:m.route("siren.procurement.show",e),class:"btn btn-xs btn-outline text-first font-bold"},{default:c(()=>[et]),_:2},1032,["onClick","href"])]),_:2},1032,["items"])]),_:2},1024)]),_:1})}}};export{mt as default};
